nodejs:
  aadIdentityName:
  image: ${IMAGE_NAME}
  ingressHost: ${SERVICE_FQDN}
  spec:
    command: ["/bin/sh"]
    args: ["-c", "yarn create:schema"]
    # These containers are run during pod initialization
    initContainers:
      name: check-db-ready
      image: postgres:9.6.5
      command: ['sh', '-c',
                'until pg_isready -U xui_tc -h $POSTGRES_SERVER_NAME -p xui_tc;
              do echo waiting for database; sleep 2; done;']
      environment:
        POSTGRES_SERVER_NAME: "{{ .Release.Name }}-postgresql"
  environment:
       NODE_TLS_REJECT_UNAUTHORIZED: '0'
       XUI_ENV: preview
       POSTGRES_SERVER_NAME: "{{ .Release.Name }}-postgresql"
       POSTGRES_USERNAME: "xui_tc"
       POSTGRES_PASSWORD: "xui_tc"
       POSTGRES_DB_NAME: "xui_tc"
  keyVaults:
    rpx:
      secrets:
        - mc-s2s-client-secret
postgresql:
  enabled: true
  postgresqlUsername: xui_tc
  postgresqlPassword: xui_tc
  postgresqlDatabase: xui_tc
  persistence:
    enabled: false
